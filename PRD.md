# 공유 캘린더 웹앱(PWA) PRD (A안: 공동 계정 + Supabase + GitHub Pages)

작성일: 2026-02-12 (KST)  
버전: v1.1

---

## 1. 한 줄 요약
부모님 2명이 **같은 일정**을 보며, 한 사람이 일정 추가/수정/삭제하면 다른 사람 화면에도 **즉시(Realtime) 반영**되는 **모바일 친화 웹앱(PWA)**.

---

## 2. 목표(Goals)
- **동기화**: 2대의 휴대폰에서 동일한 일정 상태 유지
- **단순 UX**: 부모님이 헷갈리지 않는 최소한의 입력/화면
- **운영비 최소화**: 스토어 배포 없이 웹(PWA)로 운영, Supabase Free로 시작
- **로그인 유지**: 최초 1회 로그인 후 이후 재실행 시 자동 로그인

---

## 3. 비목표(Non-goals) — v1 범위 제외
- 푸시 알림/리마인더(알람 기능)
- 반복 일정(매주/매월) *v2 후보*
- 공유 사용자 확장(3명 이상) *v2 후보*
- 첨부파일(사진/문서) *v2 후보*
- 외부 캘린더 연동(구글/아이클라우드 import/export) *v2 후보*

---

## 4. 사용자/권한 모델 (A안)
### 4.1 사용자
- 사용자: **2명(부모님)**
- 로그인 계정: **공동 계정 1개** (예: `family@...`)

### 4.2 인증 정책
- Supabase Auth 사용 (email/password)
- **세션 유지(persist session)** + **자동 갱신(auto refresh)** 활성화
- 사용자는 로그아웃을 거의 하지 않는 것을 전제로 함
- 로그아웃/세션 만료 시에만 재로그인

> NOTE: 공동 계정이므로 "누가 등록했는지"가 필요하면 `created_by_name` 같은 표시 필드를 추가(선택).

---

## 5. 핵심 사용자 시나리오(User Stories)
### US-01 일정 조회
- 부모님이 앱을 열면 **월간 달력**이 보이고, 날짜별 일정이 표시된다.

### US-02 일정 추가
- 날짜를 선택하고 제목/시간을 입력해 저장하면,
- 다른 휴대폰에서도 **즉시** 그 일정이 보인다.

### US-03 일정 수정
- 기존 일정을 눌러 수정하고 저장하면,
- 다른 휴대폰에도 **즉시** 변경이 반영된다.

### US-04 일정 삭제
- 삭제 확인 후 삭제하면,
- 다른 휴대폰에서도 **즉시** 삭제가 반영된다.

### US-05 자동 로그인
- 최초 1회 로그인 이후 앱을 껐다 켜도 다시 로그인하지 않는다.

---

## 6. 기능 요구사항 (MVP)
### 6.1 화면/기능 목록
1) **로그인 화면(최초 1회)**
- Email/Password 입력
- 로그인 성공 시 메인으로 이동
- 세션 유지(자동 로그인)

2) **메인 달력 화면(월간 뷰)**
- 이번 달 표시
- "오늘" 강조
- 날짜 클릭 → 해당 날짜 일정 목록(패널/모달/하단 시트)

3) **일정 목록/상세**
- 날짜별 일정 리스트(시간순)
- 일정 클릭 → 상세/수정 화면

4) **일정 생성/수정 화면**
- 필수: 제목, 시작일시, 종료일시(또는 종일)
- 선택: 메모, 색상(카테고리)
- 저장 / 취소 / 삭제(수정 시)

### 6.2 동기화(Realtime)
- `events` 테이블의 insert/update/delete를 Realtime 구독
- 이벤트 수신 시 UI를 갱신하는 전략(권장):
  - **가벼운 앱이라면 “변경 이벤트 수신 → 해당 월 데이터 재조회”** 방식이 안정적
  - 중복 반영/정합성 문제를 피하기 쉬움

### 6.3 오프라인/네트워크
- v1: 오프라인 편집은 지원하지 않음
- 네트워크 오류 시:
  - 저장 실패 메시지
  - 재시도 버튼 제공
- 최소: 로딩/에러 상태 UI 제공

---

## 7. 데이터 요구사항 (Supabase Postgres)
### 7.1 테이블: `events`
- 목적: 일정 저장

필드(권장 v1):
- `id` uuid PK (default gen_random_uuid())
- `title` text NOT NULL
- `start_at` timestamptz NOT NULL
- `end_at` timestamptz NOT NULL
- `all_day` boolean NOT NULL default false
- `notes` text NULL
- `color` text NULL  (예: "blue", "green" 등 or hex)
- `created_at` timestamptz NOT NULL default now()
- `updated_at` timestamptz NOT NULL default now()

선택(표시용):
- `created_by_name` text NULL (예: "아빠"/"엄마")

### 7.2 시간/타임존 정책
- DB는 `timestamptz`로 저장
- 클라이언트는 KST(Asia/Seoul) 기준으로 표시
- 종일 일정(all_day)은:
  - `start_at`을 해당 날짜 00:00 KST
  - `end_at`을 다음날 00:00 KST(또는 동일 날짜 23:59:59)로 저장 규칙 고정

---

## 8. 보안/접근 제어 (RLS)
### 8.1 원칙
- v1은 공동 계정(A안)이므로 접근 제어가 단순하지만,
- **RLS를 켜고 “로그인 사용자만 CRUD 가능”** 으로 제한한다.

### 8.2 최소 정책
- authenticated 사용자만 `events` select/insert/update/delete 가능

> NOTE: 추후 B안(개별 계정 + 공유)로 확장 시 `calendar_id`, `members` 테이블, 정책 확장 필요.

---

## 9. 기술 스택 제안
- Frontend: React + Vite (GitHub Pages 배포 용이)
- UI: 모바일 친화(큰 글씨/큰 버튼), 가능한 한 단순
- Backend/DB/Auth/Realtime: Supabase
- Hosting: GitHub Pages(정적 호스팅)
- CI/CD: GitHub Actions(선택)

---

## 10. 배포/운영
### 10.1 배포 방식
- GitHub Pages로 배포 (HTTPS)
- 부모님 폰에서:
  - Safari/Chrome로 접속
  - **“홈 화면에 추가”** 안내 (PWA처럼 사용)

### 10.2 비용 체크(요약)
- GitHub Pages: 무료(정적 호스팅)  
- Supabase: Free로 시작 가능(Realtime 포함, 쿼터 있음)  
- 주의: Free는 **비활동 시 프로젝트가 일시 중지될 수 있음**(Supabase 가격 정책 참고)

---

## 11. UX 가이드(부모님용)
- 기본 글자 크기 크게(최소 16~18px)
- 터치 영역 44px 이상
- “오늘” 버튼 제공
- 삭제는 반드시 확인 팝업
- 일정 입력 폼은 최소(제목/시간/종일/메모 정도)

---

## 12. 품질/테스트(수용 기준)
### AC-01 동기화
- 아빠 폰에서 일정 추가 → 엄마 폰 화면에 3초 이내 반영(네트워크 정상 기준)

### AC-02 자동 로그인
- 한 번 로그인 후 앱을 닫고 재접속해도 로그인 화면 없이 메인 진입

### AC-03 CRUD
- 추가/수정/삭제가 모두 정상 동작하며, 새로고침 후에도 데이터가 유지됨

### AC-04 기본 안정성
- 네트워크 오류 시 사용자에게 오류가 보이고, 앱이 멈추지 않음

---

## 13. 개발 단계(권장 순서)
### Phase 1 — 설계 (0.5~1일)
- 화면 흐름 확정(로그인/달력/폼)
- `events` 스키마 확정

### Phase 2 — Supabase 세팅 (0.5~1일)
- 프로젝트 생성, Auth 설정, `events` 테이블 생성, RLS 적용, Realtime 활성화

### Phase 3 — 프론트 MVP (1~2일)
- Vite+React 구성
- 로그인/세션 유지
- 월간 달력 + 날짜별 목록 + CRUD 구현

### Phase 4 — Realtime 동기화 (0.5~1일)
- Realtime 구독
- 이벤트 수신 시 월 데이터 재조회로 UI 갱신

### Phase 5 — UX 튜닝 & 배포 (0.5~1일)
- 큰 글씨/큰 버튼/오늘 강조/삭제 확인
- GitHub Pages 배포, 2대 폰 실사용 테스트

---

## 14. 리스크/부족한 부분 점검(이번 버전에서 보완한 항목)
- **타임존/종일 일정 규칙**(KST 기준 저장/표시) 명확화
- **오프라인/네트워크 오류 처리** 최소 요구사항 추가
- **RLS 최소 보안 정책** 명시(로그인 사용자만 접근)
- **Realtime 적용 방식**(이벤트 수신→월 재조회)로 정합성/중복 문제 예방
- **v1 범위/비범위**를 분리하여 스코프 관리

---

## 15. v2 후보(확장 아이디어)
- 반복 일정(매주/매월)
- 카테고리 고정 세트(색상 3~5개)
- 작성자 표시(아빠/엄마)
- 백업/내보내기(export)
- B안: 각자 계정 + 공유 캘린더 + 역할(읽기전용 등)